<!DOCTYPE html>
<html>
<meta charset="utf-8">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="infobar.css">

<link rel="author" href="chrispie.com">
<link rel="publisher" href="chrispie.com"/>

<body>
<script src="js/d3.v3.min.js"></script>
<script src="js/lodash.min.js"></script>
<script src="js/pixi.min.js"></script>
<script src="js/stats.min.js"></script>
<script src="js/loader.js"></script>
<script src="js/list.js"></script>
<script src="js/tags.js"></script>
<script src="js/utils.js"></script>
<script src="js/Tween.js"></script>

<div id="hiddenreload"></div>


<div id="detailTemplate" class="detail" style="display:none;">
    <h1>{{ bezeichnungen ? bezeichnungen : "Kein Titel" }}</h1>
    <p class="label">Beschreibung</p>
    <p class="description">{{ beschreibung }}</p>
    <p class="label">Kommentar</p>
    <p class="description comment">{{ kommentar }}</p>
    <!-- <p class="info">zur <a target="_blank" href="http://bestandskataloge.spsg.de/FWIV/{{ id }}">spsg.de</a></p> -->
    <p class="info"><span>Bezeichnungen</span><span>{{ bezeichnungen ? bezeichnungen : "Keine Bezeichnungen" }}</span></p>
    <p class="info"><span>Datierung</span><span>{{ zeit }}</span></p>
    <p class="info"><span>Material</span><span>{{ material }}</span></p>
    <p class="info"><span>Ma√üe</span><span>{{ hoehe }}mm * {{ breite }}mm</span></p>
    <p class="info"><span>Thementexte</span><span class="thementexte">{{ thementexte.length ? "Ja" : "Nein"}}</span></p>
    <p class="info"><span>Stichworte</span><span>{{ keywords.join(", ") }}</span></p>
    <p class="info"><span>Inventarnr.</span><span>{{ id }}</span></p>
    <p class="info"><span>Literatur</span><span>{{ literatur ? literatur : "Keine Literatur" }}</span></p>
</div>

<div class="page">
  <div class="sidebar detail hide">
    <div class="slidebutton"></div>
    <div id="render" class="inner"></div>  
  </div>

  <div class="infobar hide">
    <div class="inner">
			<h1>foo bar</h1>
			
			<p class="label">Stichworte</p>
			
			<img src="img/infobar_tags.svg">
			
			<p class="label">Zeitleiste</p>

			<img src="img/infobar_time.svg">
			
			<h1>
			
    </div>
  </div>
</div>


<script>

// copyright christopher pietsch
// cpietsch@gmail.com
// www.chrispie.com
// 2015

var data;
var imagesMap;
var imagesMap2 = d3.map([]);

var c = console.log.bind(console);

var cloud = myTagCloud();
var list = myListView();

var ping = utils.ping();

d3.select(window)
  .on("resize", function(){
    clearTimeout(window.resizedFinished);
      window.resizedFinished = setTimeout(function(){
          list.resize();
          cloud.resize();
      }, 250);
  })


d3.csv("data/timeline.csv", function(timeline){
d3.csv("data/spsg.csv", function(data){
d3.csv("data/themen.csv", function(texte){
// Loader("data/spsg.csv").finished(function(data){
// Loader("data/neu_100.csv").finished(function(images){


  window.data = data;


  c(texte)
  // data cleaning
  utils.clean(data,texte);
  
  imagesMap = d3.map(utils.fakeDataSmall(data), function(d){ return d.id; });
  // imagesMap = d3.map(images, function(d){ return d.id; });
  imagesMap2 = d3.map(utils.fakeDataBig(data), function(d){ return d.id; });

  // Loader("data/neu_1000.csv").finished(function(images2){
  //   imagesMap2 = d3.map(images2, function(d){ return d.id; });
  // });


  cloud.init(data);
  
  list.loadTimeline(timeline);
  list.init(data);


  cloud.mouseenterCallback(function(d){
    list.highlight(d);
  })

  cloud.mouseclickCallback(function(d){
    list.flip(d);
  })


 
// });
});
});
});

d3.select("#hiddenreload").on("click", function(){
  location.reload();
})

d3.select(".splash .btn").on("click", function(){
  d3.select(".splash").style({ display: "none" });
  //utils.fullscreen();
})


window.onbeforeunload = function() {
    // todo: tracking stuff

};


</script>

</body>
</html>